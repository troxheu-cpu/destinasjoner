<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Destinasjoner</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#0b0f14; color:#e7eef8; }
    .app { display:flex; height:100vh; }
    .side {
      width:380px; min-width:300px; max-width:460px;
      border-right:1px solid rgba(255,255,255,.08);
      padding:14px; box-sizing:border-box; overflow:auto;
    }
    .title { font-size:18px; font-weight:700; margin:0 0 10px; }
    .hint { font-size:12px; opacity:.75; margin:0 0 12px; line-height:1.4; }

    .row { display:flex; gap:8px; }
    input, select {
      width:100%; padding:10px 10px; border-radius:10px;
      border:1px solid rgba(255,255,255,.12);
      background:#111826; color:#e7eef8;
      outline:none;
    }
    input::placeholder { color: rgba(231,238,248,.6); }
    .list { margin-top:12px; display:flex; flex-direction:column; gap:10px; }
    .card {
      padding:10px; border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:#0f1623;
      cursor:pointer;
    }
    .card:hover { border-color: rgba(255,255,255,.22); }
    .name { font-weight:700; }
    .desc { font-size:12px; opacity:.82; margin-top:6px; line-height:1.35; }
    .meta { font-size:12px; opacity:.70; margin-top:6px; }
    .thumb { width:100%; border-radius:10px; margin-top:8px; display:block; }
    .badge {
      display:inline-block; font-size:11px; padding:2px 8px; border-radius:999px;
      background: rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.10);
      margin-right:6px;
    }

    #map { flex:1; }

    @media (max-width: 900px) {
      .app { flex-direction:column; }
      .side { width:100%; max-width:none; height:46vh; border-right:none; border-bottom:1px solid rgba(255,255,255,.08); }
      #map { height:54vh; }
    }
  </style>
</head>
<body>

<div class="app">
  <aside class="side">
    <div class="title">Destinasjoner</div>
    <div class="hint">Søk, filtrer og klikk på en destinasjon for å zoome inn på kartet.</div>

    <div class="row">
      <input id="q" placeholder="Søk (navn / sted / tips)" />
      <select id="cat">
        <option value="">Alle</option>
        <option value="natur">Natur</option>
        <option value="kultur">Kultur</option>
        <option value="aktiviteter">Aktiviteter</option>
        <option value="mat">Mat</option>
        <option value="overnatting">Overnatting</option>
        <option value="shopping">Shopping</option>
        <option value="utsikt">Utsikt</option>
      </select>
    </div>

    <div class="list" id="list"></div>
  </aside>

  <div id="map"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  // ========= DATA =========
  // Tips: Du kan legge til flere destinasjoner ved å kopiere en blokk og endre innholdet.
  const steder = [
    {
      navn: "Bryggen",
      beskrivelse: "Historisk havnefront med fargerike trehus og smale smug.",
      lat: 60.3971, lon: 5.3249,
      kategori: "kultur",
      sesong: "hele_året",
      rating: 5,
      bilde: "https://commons.wikimedia.org/wiki/Special:FilePath/Bryggen%20Bergen.jpg",
      tips: "Best tidlig morgen eller kveld.",
      sted: "Bergen"
    },

    {
      navn: "Ravnåsen utsiktspunkt",
      beskrivelse: "Skogkledd høyde med flott utsikt over Sandefjord og fjorden.",
      lat: 59.1346, lon: 10.2169,
      kategori: "utsikt",
      sesong: "hele_året",
      rating: 4,
      bilde: "",
      tips: "Fin kveldstur med solnedgang.",
      sted: "Sandefjord"
    },
    {
      navn: "Essoskogen",
      beskrivelse: "Rolig turområde med merkede stier og variert skog.",
      lat: 59.2795, lon: 10.3532,
      kategori: "natur",
      sesong: "hele_året",
      rating: "",
      bilde: "",
      tips: "Egner seg godt for barnefamilier.",
      sted: "Tønsberg"
    },
    {
      navn: "Berg gamle kirke",
      beskrivelse: "Middelalderkirke i landlige omgivelser.",
      lat: 59.4029, lon: 10.3654,
      kategori: "kultur",
      sesong: "hele_året",
      rating: 4,
      bilde: "",
      tips: "Kombiner med rusletur i nærområdet.",
      sted: "Horten"
    },
    {
      navn: "Ula strand",
      beskrivelse: "Småstrand med svaberg og badeplasser.",
      lat: 58.9007, lon: 10.0053,
      kategori: "natur",
      sesong: "sommer",
      rating: 5,
      bilde: "",
      tips: "Kom tidlig på varme dager.",
      sted: "Larvik"
    },
    {
      navn: "Huldrestier i Andebu",
      beskrivelse: "Eventyrlige skogsstier med lokal folklore.",
      lat: 59.2984, lon: 10.1968,
      kategori: "aktiviteter",
      sesong: "vår",
      rating: "",
      bilde: "",
      tips: "Perfekt for rolig dagstur.",
      sted: "Andebu"
    },
    {
      navn: "Ilene våtmarksområde",
      beskrivelse: "Viktig naturområde for fugleliv og naturopplevelser.",
      lat: 59.2861, lon: 10.4712,
      kategori: "natur",
      sesong: "vår",
      rating: 5,
      bilde: "",
      tips: "Ta med kikkert.",
      sted: "Tønsberg"
    },
    {
      navn: "Huseby kystfort",
      beskrivelse: "Historisk kystfort fra andre verdenskrig.",
      lat: 59.0487, lon: 10.0129,
      kategori: "kultur",
      sesong: "hele_året",
      rating: 4,
      bilde: "",
      tips: "Flott utsikt mot havet.",
      sted: "Larvik"
    },
    {
      navn: "Melsomvik badeplass",
      beskrivelse: "Familievennlig strand med gressletter og svaberg.",
      lat: 59.2278, lon: 10.3324,
      kategori: "natur",
      sesong: "sommer",
      rating: "",
      bilde: "",
      tips: "God plass til piknik.",
      sted: "Sandefjord"
    },
    {
      navn: "Hjertnespromenaden",
      beskrivelse: "Moderne promenade med utsikt og byliv.",
      lat: 59.1312, lon: 10.2254,
      kategori: "kultur",
      sesong: "hele_året",
      rating: 4,
      bilde: "",
      tips: "Hyggelig kveldstur.",
      sted: "Sandefjord"
    },
    {
      navn: "Borrevannet rundt",
      beskrivelse: "Flat og naturskjønn rundtur langs innsjø.",
      lat: 59.3806, lon: 10.4189,
      kategori: "aktiviteter",
      sesong: "hele_året",
      rating: "",
      bilde: "",
      tips: "Passer også for sykkel.",
      sted: "Borre"
    }
  ];

  // ========= KART =========
  const map = L.map('map').setView([59.20, 10.25], 9);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap'
  }).addTo(map);

  const markers = new Map();

  function safeText(v) {
    return (v === null || v === undefined) ? "" : String(v);
  }

  function popupHtml(s) {
    const img = s.bilde ? `<img class="thumb" src="${s.bilde}" alt="">` : "";
    const rating = s.rating ? `⭐ ${s.rating}/5` : "";
    const meta = [s.kategori, s.sesong, rating, s.sted].filter(Boolean).join(" • ");
    const tips = s.tips ? `<div style="margin-top:8px;opacity:.9"><em>${safeText(s.tips)}</em></div>` : "";
    return `
      <div style="max-width:300px">
        <div style="font-weight:700">${safeText(s.navn)}</div>
        <div style="opacity:.86;margin-top:4px">${safeText(s.beskrivelse)}</div>
        <div style="opacity:.7;font-size:12px;margin-top:6px">${meta}</div>
        ${img}
        ${tips}
      </div>
    `;
  }

  function ensureMarker(s) {
    const key = `${s.navn}__${s.lat}__${s.lon}`;
    if (markers.has(key)) return markers.get(key);
    const m = L.marker([s.lat, s.lon]).addTo(map).bindPopup(popupHtml(s));
    markers.set(key, m);
    return m;
  }

  function render() {
    const q = document.getElementById("q").value.trim().toLowerCase();
    const cat = document.getElementById("cat").value;

    const filtered = steder.filter(s => {
      const text = `${safeText(s.navn)} ${safeText(s.beskrivelse)} ${safeText(s.tips)} ${safeText(s.sted)}`.toLowerCase();
      const okQ = !q || text.includes(q);
      const okC = !cat || s.kategori === cat;
      return okQ && okC;
    });

    const list = document.getElementById("list");
    list.innerHTML = "";

    filtered.forEach(s => ensureMarker(s));

    filtered.forEach(s => {
      const card = document.createElement("div");
      card.className = "card";

      const badges = [
        s.kategori ? `<span class="badge">${safeText(s.kategori)}</span>` : "",
        s.sesong ? `<span class="badge">${safeText(s.sesong)}</span>` : "",
        s.rating ? `<span class="badge">⭐ ${safeText(s.rating)}/5</span>` : ""
      ].filter(Boolean).join("");

      card.innerHTML = `
        <div class="name">${safeText(s.navn)}</div>
        <div class="meta">${badges}${s.sted ? `<span class="badge">${safeText(s.sted)}</span>` : ""}</div>
        <div class="desc">${safeText(s.beskrivelse)}</div>
        ${s.bilde ? `<img class="thumb" src="${s.bilde}" alt="">` : ""}
      `;

      card.onclick = () => {
        const m = ensureMarker(s);
        map.setView([s.lat, s.lon], 15);
        m.openPopup();
      };

      list.appendChild(card);
    });

    if (filtered.length === 0) {
      list.innerHTML = `<div style="opacity:.75;padding:8px;">Ingen treff.</div>`;
    }
  }

  document.getElementById("q").addEventListener("input", render);
  document.getElementById("cat").addEventListener("change", render);

  render();

  // Zoom slik at alle markører er synlige ved oppstart
  const bounds = L.latLngBounds(steder.map(s => [s.lat, s.lon]));
  map.fitBounds(bounds.pad(0.2));
</script>

</body>
</html>


